init:
    $ mods["art_of_new_life"] = u"Искусство новой жизни"
    $ mod_tags["art_of_new_life"] = ["gameplay:vn","length:days","protagonist:female","character:Лена","character:Семён","character:Алиса","character:Славя","character:Женя","character:Шурик","character:Электроник","character:Ольга Дмитриевна","character:Виола","character:Ульяна","character:Александр"]
    #TODO: исправить во всех днях все метки #TODO и #FIXME
    
init 2:
    $ aonl_imgs = "art_of_new_life/images/"
    
    ################
    # BG
    ################
    
    image bg aonl_int_dining_hall_people_sunset = aonl_imgs + "bg/int_dining_hall_people_sunset.jpg"
    image bg aonl_ext_boathouse_sunset = aonl_imgs + "bg/ext_boathouse_sunset.jpg"
    image bg aonl_ext_library_sunset = aonl_imgs + "bg/ext_library_sunset.jpg"
    image bg aonl_ext_house_of_un_night = aonl_imgs + "bg/ext_house_of_un_night.jpg"
    image bg aonl_ext_shed_day = aonl_imgs + "bg/ext_shed_day.jpg"
    image bg aonl_ext_houses_night = aonl_imgs + "bg/ext_houses_night.jpg"
    image bg aonl_ext_houses_night_dark = aonl_imgs + "bg/ext_houses_night_dark.jpg"
    image bg aonl_int_aidpost_night_nolight = aonl_imgs + "bg/int_aidpost_night_nolight.jpg"
    image bg aonl_ext_house_of_mt_night_dark = aonl_imgs + "bg/ext_house_of_mt_night_dark.jpg"
    image bg aonl_ext_old_building_day = aonl_imgs + "bg/ext_old_building_day.jpg"
    image bg aonl_ext_bathhouse_day = aonl_imgs + "bg/ext_bathhouse_day.jpg"
    image bg aonl_int_bathhouse = aonl_imgs + "bg/int_bathhouse.jpg"
    image bg aonl_ext_playground_sunset = aonl_imgs + "bg/ext_playground_sunset.jpg"
    image bg aonl_ext_forest_lake_day = aonl_imgs + "bg/ext_forest_lake_day.jpg"
    image bg aonl_int_mine_red = im.MatrixColor("images/bg/int_mine.jpg", im.matrix.tint(1, 0.35, 0.35) )
    image bg aonl_int_lena_flat_night = aonl_imgs + "bg/int_lena_flat_night.jpg"
    image bg aonl_int_lena_flat_ceiling = aonl_imgs + "bg/int_lena_flat_ceiling.jpg"
    image bg aonl_ext_winter_street_night = aonl_imgs + "bg/ext_winter_street_night.jpg"
    image bg aonl_ext_airport_dream = aonl_imgs + "bg/ext_airport_dream.jpg"
    image bg aonl_sky = aonl_imgs + "bg/ext_sky.png"
    image bg aonl_water = aonl_imgs + "bg/ext_water.jpg"
    image bg aonl_staircase = aonl_imgs + "bg/int_staircase.jpg"
    image bg aonl_un_stud = aonl_imgs + "bg/int_un_stud.jpg"
    image bg aonl_artist_day = aonl_imgs + "bg/int_lib_artist_day.png"
    image bg aonl_ext_house_of_un_sunset = aonl_imgs + "bg/ext_house_of_un_sunset.jpg"
    image bg aonl_foge = aonl_imgs + "bg/ext_foge.jpg"
    image bg aonl_int_house_of_un_sunset = aonl_imgs + "bg/int_house_of_un_sunset.jpg"
    image bg aonl_ext_musclub_sunset = aonl_imgs + "bg/ext_musclub_sunset.jpg"
    image bg aonl_ext_musclub_verandah = aonl_imgs + "bg/ext_musclub_verandah.jpg"
    image bg aonl_int_musclub_sunset = aonl_imgs + "bg/int_musclub_sunset.jpg"
    image bg aonl_int_stairs = aonl_imgs + "bg/int_stairs.jpg"
    image bg aonl_foge_mine = aonl_imgs + "bg/foge_mine.jpg"
    image bg aonl_fog_everywere = aonl_imgs + "bg/fog_everywere.jpg"
    image bg aonl_int_un_stud = aonl_imgs + "bg/int_un_stud.jpg"
    image bg aonl_int_staircase_2 = aonl_imgs + "bg/int_staircase_2.jpg"
    image bg aonl_int_stairs_2 = aonl_imgs + "bg/int_stairs_2.jpg"
    image bg aonl_ext_cemetry_night = aonl_imgs + "bg/ext_cemetry_night.jpg"
    image bg aonl_ext_river_bridge_night = aonl_imgs + "bg/ext_river_bridge_night.jpg"
    image bg aonl_ext_underwater = aonl_imgs + "bg/ext_underwater.jpg"
    image bg aonl_ext_dining_hall_behind = aonl_imgs + "bg/ext_dining_hall_behind.jpg"
    image bg aonl_ext_forest_lake_night = aonl_imgs + "bg/ext_forest_lake_night.png"
    image bg aonl_int_lib_artist_night = aonl_imgs + "bg/int_lib_artist_night.jpg"
    image bg aonl_int_aidpost_night_light = aonl_imgs + "bg/int_aidpost_night_light.jpg"
    image bg aonl_ext_square_fog = aonl_imgs + "bg/ext_square_fog.png"
    image bg aonl_ext_house_of_un_sunset1 = aonl_imgs + "bg/aonl_ext_house_of_un_sunset1.png"
    image bg ext_house_of_un_night_7dl = aonl_imgs + "bg/ext_house_of_un_night_7dl.jpg"   
    image bg ext_aidpost_nigh_after_rain = aonl_imgs + "bg/ext_aidpost_nigh_after_rain.png"
    
    
    ################
    # Video
    ################
    
    
    #video opening1 = "art_of_new_life/video/opening1.ogv"
    
    
    
    
    
    
    
    ################
    # CG
    ################
    
    image cg aonl_un_parents = aonl_imgs + "cg/un_parents.png"
    image cg aonl_un_paints_mi = aonl_imgs + "cg/un_paints_mi.png"
    image cg aonl_un_diary = aonl_imgs + "cg/un_diary.png"
    image cg aonl_un_diary_evil = aonl_imgs + "cg/un_diary_evil.png"
    image cg aonl_un_semen_lib = aonl_imgs + "cg/un_semen_lib.png"
    image cg aonl_lineup_with_mi = aonl_imgs + "cg/lineup_with_mi.png"
    image cg aonl_lena_winter_prolog = aonl_imgs + "cg/lena_winter_prolog.png"
    image cg aonl_lena_winter_prolog_2 = aonl_imgs + "cg/lena_winter_prolog_2.png"
    image cg aonl_d2_un_child_cry1 = aonl_imgs + "cg/d2_un_child_cry1.jpg"
    image cg aonl_d2_un_child_cry2 = aonl_imgs + "cg/d2_un_child_cry2.jpg"
    image cg aonl_d2_un_child_cry3 = aonl_imgs + "cg/d2_un_child_cry3.jpg"
    image cg aonl_d4_un_semyon_1 = aonl_imgs + "cg/d4_un_semyon_1.jpg"
    image cg aonl_d4_un_semyon_2 = aonl_imgs + "cg/d4_un_semyon_2.jpg"
    image cg aonl_d6_un_mirror_1 = aonl_imgs + "cg/d6_un_mirror_1.jpg"
    image cg aonl_d6_un_mirror_2 = aonl_imgs + "cg/d6_un_mirror_2.jpg"
    image cg aonl_d6_un_dance = aonl_imgs + "cg/d6_un_dance.jpg"
    image cg aonl_un_farewell = aonl_imgs + "cg/un_farewell.png"
    image cg aonl_un_farewell1 = aonl_imgs + "cg/un_farewell1.png"
    image cg aonl_cl_d4_un_knees = aonl_imgs + "cg/cl_d4_un_knees.jpg"
    image cg aonl_mi_shur_kiss = aonl_imgs + "cg/mi_shur_kiss.jpg"
    image cg aonl_epilogue_un_good_birth = aonl_imgs + "cg/epilogue_un_good_birth.jpg"
    image cg aonl_epilogue_un_good_wedding1 = aonl_imgs + "cg/epilogue_un_good_wedding1.jpg"
    image cg aonl_epilogue_un_good_wedding2 = aonl_imgs + "cg/epilogue_un_good_wedding2.jpg"
    image cg aonl_epilogue_un_bad_grave = aonl_imgs + "cg/epilogue_un_bad_grave.jpg"
    image cg aonl_epilogue_un_bad_falling = aonl_imgs + "cg/epilogue_un_bad_falling.jpg"
    image cg aonl_lena_make_robot = aonl_imgs + "cg/lena_make_robot.jpg"
    image cg aonl_un_diary_night_good_end = aonl_imgs + "cg/un_diary_night_1.jpg"
    image cg aonl_bath_2 = aonl_imgs + "cg/bath2.jpg"
    image cg aonl_bath_1 = aonl_imgs + "cg/bath1.jpg"
    image cg aonl_semen_traitor_2 = aonl_imgs + "cg/semen_traitor_2.jpg"
    image cg aonl_semen_traitor_1 = aonl_imgs + "cg/semen_traitor_1.jpg"
    image cg aonl_un_artist_brush = aonl_imgs + "cg/un_artist_brush.png"
    image cg aonl_un_artist_pencil = aonl_imgs + "cg/un_artist_pencil.png"
    image cg aonl_un_on_boot_day = aonl_imgs + "cg/un_on_boot_day.png"
    image cg aonl_un_on_boot_sad = aonl_imgs + "cg/un_on_boot_sad.png"
    image cg aonl_un_cry_1 = aonl_imgs + "cg/un_cry_1.png"
    image cg aonl_un_cry_2 = aonl_imgs + "cg/un_cry_2.png"
    image cg aonl_un_hugs = aonl_imgs + "cg/un_hugs.png"
    image cg aonl_un_tea_party_happy = aonl_imgs + "cg/tea_party_happy.png"
    image cg aonl_tea_party_sad = aonl_imgs + "cg/tea_party_sad.png"
    image cg un_dance1 = aonl_imgs + "cg/un_dance1.jpg"
    image cg sl_dance1 = aonl_imgs + "cg/sl_dance1.png"
    
    
    
    
    
    
    
    
    ################
    # Смена дней
    ################
    
    image aonl_days_bg = aonl_imgs + "misc/days/background.jpg"
    
    python:
        for num in range (0, 11):
            renpy.image("aonl_day"+str(num), aonl_imgs + "misc/days/day"+str(num)+".png")
        def aonl_chapter(aonl_day_num):
            global save_name
            if aonl_day_num == 11:
                save_name = "Искусство новой жизни.\nЭпилог"
            elif aonl_day_num == 0:     # мало кто будет сохраняться на прологе, но надо делать всё идеально
                save_name = "Искусство новой жизни.\nПролог"
            else:
                save_name = "Искусство новой жизни.\nДень " + str(aonl_day_num)
            renpy.scene()
            renpy.show("aonl_days_bg")
            renpy.transition(dissolve)
            renpy.pause(1)
            renpy.show("aonl_day" + str(aonl_day_num) )
            renpy.transition(dissolve)
            renpy.pause()
            renpy.scene()
            renpy.show("bg black")
            renpy.transition(dissolve)
            renpy.pause(2)
    
    ################
    # Карточный турнир
    ################
    
    $ aonl_me_ava = aonl_imgs + "avatars/me/me-"
    $ aonl_me_avatar_set = {
            'body':aonl_me_ava + 'body.png',
            -2:aonl_me_ava + 'emo01.png',
            -1:aonl_me_ava + 'emo01.png',
            0:aonl_me_ava + 'emo01.png',
            1:aonl_me_ava + 'emo01.png',
            2:aonl_me_ava + 'emo05.png'
        }
    
    python:
        def aonl_reload_cards():
            global prefix
            global ints
            global types
            global card_img
            prefix = aonl_imgs + "cards/"
            for i in ints:
                for j in types:
                    name = "%d_%s"%(i,j)
                    card_img[(i,j)] = get_img(name)

    ################
    # Музыка
    ################
    
    # Yasuharu Takanashi/Yaiba - Samidare
    $ aonl_mus_samidare = "art_of_new_life/music/Samidare.mp3"
    # Takanashi Yasuharu - Shitsui
    $ aonl_mus_shitsui = "art_of_new_life/music/Shitsui.mp3"
    # Hatsune Miku - Hazy Moon
    $ aonl_mus_hazy_moon = "art_of_new_life/music/Hazy Moon.mp3"
    # April Rain - My silent angel
    $ aonl_mus_silent_angel = "art_of_new_life/music/silent_angel.ogg"
    # April Rain - 7 Days of Summer
    $ aonl_7_days_of_summer = "art_of_new_life/music/7_days_summer.mp3"
    # Umineko no Naku Koro ni Fortitude
    $ aonl_fortitude = "art_of_new_life/music/Fortitude.mp3"
    # One Day in London - Prologe
    $ aonl_lena_diary_writing = "art_of_new_life/music/lena_diary_writing.mp3"
    # Dies Irae Keishi Yonao Odi et Amo лат. "Ненавижу и люблю"
    $ aonl_odi_et_amo = "art_of_new_life/music/Odi_et_Amo.mp3"
    # One Day in London - Ovium
    $ aonl_Lena_dream_1 = "art_of_new_life/music/Lena_dream_1.mp3"
    # Keishi Yonao Dies irae OST Ewige Wiederkunft
    $ aonl_thoughtfulness = "art_of_new_life/music/Ewige_Wiederkunft.mp3"
    # Higurashi Kai VN BGM Birth and Death
    $ aonl_birth_and_death = "art_of_new_life/music/Birth_and_Death.mp3"
    # Lucy -The Eternity She Wished For OST Wake up
    $ aonl_wake_up = "art_of_new_life/music/wake_up.mp3"
    # Fate_Stay Night - Pursuing Minds
    $ aonl_pursuing_minds = "art_of_new_life/music/Pursuing_Minds.mp3"
    # Higanbana No Saku Yoru Ni OST - Dark Music
    $ aonl_quietness = "art_of_new_life/music/quietness.ogg"
    # Keishi Yonao Dies irae OST - Disce libens
    $ aonl_disce_libens = "art_of_new_life/music/Disce libens.mp3"
    # One Day in London OST - I'm so Sorry
    $ aonl_i_am_so_sorry = "art_of_new_life/music/I'm so Sorry.mp3"
    # Umineko no Naku Koro ni OST - Requiem
    $ aonl_requiem = "art_of_new_life/music/Requiem.mp3"
    # Lucy -The Eternity She Wished For OST Fountane
    $ aonl_calm = "art_of_new_life/music/calm.mp3"
    # Sakura Fantasy Chapter 1 OST - Chocolate
    $ aonl_honey_bath = "art_of_new_life/music/honey bath.mp3"
    # Higurashi Visual Novel BGM Gear
    $ aonl_gear = "art_of_new_life/music/gear.mp3"
    # Keishi Yonao Dies irae OST - Walhall
    $ aonl_happiness = "art_of_new_life/music/walhall.mp3"
    # Higurashi Kai Visual Novel BGM - Soul Scour
    $ aonl_lena_memories = "art_of_new_life/music/lena_memories.mp3"
    # are_you_a_bully
    $ aonl_are_you_a_bully = "art_of_new_life/music/are_you_a_bully.mp3"
    # One Day in London - Acedia Theme
    $ aonl_mistic_death = "art_of_new_life/music/mistic_death.mp3"
    # Sakura Beach OST Space Boy
    $ aonl_stars = "art_of_new_life/music/space.mp3"
    # Аквариум - Золотой Город Инструментал кавер
    $ aonl_gold_town = "art_of_new_life/music/gold_town.mp3"
    # Higurashi Kai VN BGM Over The Sky
    $ aonl_over_the_sky = "art_of_new_life/music/over_the_sky.mp3"
    # Higurashi Kai VN BGM Kyouki he no Kairou
    $ aonl_strange = "art_of_new_life/music/Kyouki he no Kairou.mp3"
    
    $ perebor = "art_of_new_life/music/perebor.mp3"
    
   
    
    
    
    
    
    ################
    # Звуки
    ################

    $ aonl_sfx_stahp = "art_of_new_life/sfx/stahp.ogg"
    $ aonl_sfx_pen_writting = "art_of_new_life/sfx/aonl_pen_writting.mp3"
    $ aonl_amb_hard_rain_outside = "art_of_new_life/sfx/hard_rain_outside.ogg"
    $ aonl_winter_loop = "art_of_new_life/sfx/winter_loop.mp3"
    $ mir_ruhnul = "art_of_new_life/sfx/mir_ruhnul.mp3"
    $ volni = "art_of_new_life/sfx/volni.mp3"   
    $ ydar_gitara = "art_of_new_life/sfx/ydar_gitara.ogg"  
    $ Par = "art_of_new_life/sound1/Par.mp3"
    $ Vetka_lomaetci = "art_of_new_life/sound1/Vetka_lomaetci.mp3"
    $ padaet_vilka = "art_of_new_life/sound1/padaet_vilka.mp3"
    
    
    ################
    # Голоса
    ################
    
    $ colors['aonl_mi'] = {'night': (0, 180, 207, 255), 'sunset': (0, 252, 255, 255), 'day': (0, 222, 255, 255), 'prolog': (0, 222, 255, 255)}
    $ names['aonl_mi'] = "Девочка"
    $ store.names_list.append('aonl_mi')
    
    $ colors['aonl_mt'] = {'night': (0, 182, 39, 255), 'sunset': (0, 234, 50, 255), 'day': (0, 234, 50, 255), 'prolog': (0, 234, 50, 255)}
    $ names['aonl_mt'] = "Женщина"
    $ store.names_list.append('aonl_mt')
    
    $ colors['aonl_ma'] = {'night': (20, 155, 250, 255), 'sunset': (20, 155, 250, 255), 'day': (20, 155, 250, 255), 'prolog': (20, 155, 250, 255)}
    $ names['aonl_ma'] = "Мама"
    $ store.names_list.append('aonl_ma')
    
    $ colors['aonl_pa'] = {'night': (20, 155, 250, 255), 'sunset': (20, 155, 250, 255), 'day': (20, 155, 250, 255), 'prolog': (20, 155, 250, 255)}
    $ names['aonl_pa'] = "Папа"
    $ store.names_list.append('aonl_pa')
    
    $ colors['aonl_mz'] = {'night': (84, 129, 219, 255), 'sunset': (114, 160, 255, 255), 'day': (74, 134, 255, 255), 'prolog': (74, 134, 255, 255)}
    $ names['aonl_mz'] = "Библиотекарь"
    $ store.names_list.append('aonl_mz')
    
    $ colors['aonl_un_sl'] = {'night': (170, 100, 217, 255), 'sunset': (185, 86, 255, 255), 'day': (185, 86, 255, 255), 'prolog': (185, 86, 255, 255)}
    $ names['aonl_un_sl'] = "Лена и Славя"
    $ store.names_list.append('aonl_un_sl')
    
    $ colors['aonl_un_mi'] = {'night': (170, 100, 217, 255), 'sunset': (185, 86, 255, 255), 'day': (185, 86, 255, 255), 'prolog': (185, 86, 255, 255)}
    $ names['aonl_un_mi'] = "Лена и Мику"
    $ store.names_list.append('aonl_un_mi')
    
    $ colors['aonl_voice'] = {'night': (128, 128, 128, 255), 'sunset': (128, 128, 128, 255), 'day': (128, 128, 128, 255), 'prolog': (128, 128, 128, 255)}
    $ names['aonl_voice'] = "Голос"
    $ store.names_list.append('aonl_voice')
    
    $ colors['aonl_dark_un'] = {'night': (128, 128, 128, 255), 'sunset': (128, 128, 128, 255), 'day': (128, 128, 128, 255), 'prolog': (128, 128, 128, 255)}
    $ names['aonl_dark_un'] = "Лена"
    $ store.names_list.append('aonl_dark_un')
    
    # Каноничная версия
    
    $ colors['aonl_boss'] = {'night': (225, 221, 125, 255), 'sunset': (225, 221, 125, 255), 'day': (225, 221, 125, 255), 'prolog': (225, 221, 125, 255)}
    $ names['aonl_boss'] = "Босс"
    $ store.names_list.append('aonl_boss')
    
    $ colors['aonl_boy'] = {'night': (225, 221, 125, 255), 'sunset': (225, 221, 125, 255), 'day': (225, 221, 125, 255), 'prolog': (225, 221, 125, 255)}
    $ names['aonl_boy'] = "Мальчик"
    $ store.names_list.append('aonl_boy')
    
    $ colors['aonl_man'] = {'night': (225, 221, 125, 255), 'sunset': (225, 221, 125, 255), 'day': (225, 221, 125, 255), 'prolog': (225, 221, 125, 255)}
    $ names['aonl_man'] = "Мужчина"
    $ store.names_list.append('aonl_man')
    
    $ colors['aonl_un25'] = {'night': (170, 100, 217, 255), 'sunset': (185, 86, 255, 255), 'day': (185, 86, 255, 255), 'prolog': (185, 86, 255, 255)}
    $ names['aonl_un25'] = "Женщина"
    $ store.names_list.append('aonl_un25')
    
    ################
    # Переменные
    ################
    
    $ aonl_d2_island = False
    $ aonl_d2_play = False
    $ aonl_d2_mz_wake = False
    $ aonl_d5_dark_un_help = False
    $ aonl_d5_dark_un_disturb = False
    
    # Переменные для каноничной версии
    
    $ aonl_classic_miku_route = False

    ################
    # ATL
    ################
    
    transform aonl_wake_up1:
        anchor (0.0, 0.0) pos (0.0, 0.0)
        linear 0.1 pos (-7, -5)
        linear 0.1 pos (0, 0)
        linear 0.1 pos (7, -5)
        linear 0.1 pos (0, 0)

    transform aonl_running:
        anchor (0.0, 0.0) pos (0.0, 0.0)
        linear 0.1 pos (-7, -5)
        linear 0.1 pos (0, 0)
        linear 0.1 pos (7, -5)
        linear 0.1 pos (0, 0)
        repeat
    
    image aonl_un_house_with_un:
        contains:
            "bg ext_house_of_un_day"
        contains:
            "un smile pioneer"
            center
            
    image aonl_un_dance:
        contains:
            "bg ext_square_night_party"
        contains:
            "un smile dress"
            center
            
    image aonl_slideshow:
        choice:
            "cg d3_un_dance" with Dissolve(3)
        choice:
            "cg d3_un_forest" with Dissolve(3)
        choice:
            "cg d4_catac_un" with Dissolve(3)
        choice:
            "cg d5_un_island" with Dissolve(3)
        choice:
            "cg d5_un_sleep" with Dissolve(3)
        choice:
            "cg d6_un_evening_1" with Dissolve(3)
        choice:
            "cg epilogue_un" with Dissolve(3)
        choice:
            "cg epilogue_un_good" with Dissolve(3)
        choice:
            "cg d2_lineup" with Dissolve(3)
        choice:
            "aonl_un_house_with_un" with Dissolve(3)
        choice:
            "aonl_un_dance" with Dissolve(3)
        pause 4
        repeat
        
    image aonl_ext_house_of_mt_night_dark_fade:
        "bg aonl_ext_house_of_mt_night_dark"
        "bg black" with Dissolve(5)

    ################
    # Стили
    ################
    
    # Стиль главного меню
    $ style.aonl_mm = Style(style.default)
    $ style.aonl_mm.color = '#fff'
    $ style.aonl_mm.hover_color = '#B956FF'
    $ style.aonl_mm.selected_color = '#B956FF'
    $ style.aonl_mm.selected_idle_color = '#B956FF'
    $ style.aonl_mm.selected_hover_color = '#B956FF'
    $ style.aonl_mm.insensitive_color = '#888888'
    $ style.aonl_mm.size = 55
    $ style.aonl_mm.font = "art_of_new_life/fonts/ametist.ttf"
    $ style.aonl_mm.outlines = [(3, '#000', 0, 0)]
    $ style.aonl_mm.text_align = 0.5

    # Стиль музыкальной комнаты
    $ style.aonl_mroom = Style(style.aonl_mm)
    # $ style.aonl_mroom.color = '#fff'
    # $ style.aonl_mroom.hover_color = '#B956FF'
    # $ style.aonl_mroom.selected_color = '#B956FF'
    # $ style.aonl_mroom.selected_idle_color = '#B956FF'
    # $ style.aonl_mroom.selected_hover_color = '#B956FF'
    # $ style.aonl_mroom.insensitive_color = '#888888'
    # $ style.aonl_mroom.size = 55
    # $ style.aonl_mroom.font = "art_of_new_life/fonts/ametist.ttf"
    # $ style.aonl_mroom.outlines = [(3, '#000', 0, 0)]
    $ style.aonl_mroom.text_align = 0.0
    
    # Шрифт титров и надписей
    $ style.aonl_credits = Style(style.default)
    $ style.aonl_credits.font  = "fonts/corbelb.ttf"
    $ style.aonl_credits.color = "#fff"
    $ style.aonl_credits.drop_shadow = [ (1, 1), (1, 1), (1, 1), (1, 1) ]
    $ style.aonl_credits.drop_shadow_color = "#000"
    $ style.aonl_credits.italic = False
    $ style.aonl_credits.bold = False
    $ style.aonl_credits.text_align = 0.5
    $ style.aonl_credits.xmaximum = 0.8

    image aonl_credits = ParameterizedText(style = "aonl_credits", size = 50)
    
    $ aonl_rupster_script = "art_of_new_life/fonts/rupster_script.ttf"
    
    $ config.mouse["aonl_un"] = [(aonl_imgs + "misc/cursor.png", 0, 0)]
    $ config.mouse["aonl_un_bad"] = [(aonl_imgs + "misc/bad_end_cursor.png", 0, 0)]
    
    ################
    # Music Room
    ################
    
    python:
        aonl_mr = MusicRoom(fadeout=1.0)
        aonl_mr.add("art_of_new_life/music/Samidare.mp3")
        aonl_mr.add("art_of_new_life/music/Shitsui.mp3")
        aonl_mr.add("art_of_new_life/music/Hazy Moon.mp3")
        aonl_mr.add("art_of_new_life/music/silent_angel.ogg")
   
    ################
    # Галерея
    ################
    
    python:
        aonl_g = Gallery()

        aonl_g.transition = fade
        aonl_g.locked_button = get_image("gui/gallery/not_opened_idle.png")
        aonl_g.unlocked_button = get_image("gui/gallery/blank.png")
        
        aonl_gallery_bg = [
        "int_dining_hall_people_sunset",
        "ext_boathouse_sunset",
        "ext_library_sunset",
        "ext_shed_day",
        "ext_houses_night",
        "ext_houses_night_dark",
        "int_aidpost_night_nolight",
        "ext_house_of_mt_night_dark",
        "ext_house_of_un_night",
        ]
        
        aonl_gallery_cg = [
        "un_parents",
        "un_paints_mi",
        "un_diary",
        "un_diary_evil",
        "un_semen_lib",
        ]
    
        for cg in aonl_gallery_cg:
            aonl_g.button(cg)
            aonl_g.image("art_of_new_life/images/cg/"+cg+".png")
            aonl_g.unlock("cg aonl_"+cg)

        for bg in aonl_gallery_bg:
            aonl_g.button(bg)
            aonl_g.image("art_of_new_life/images/bg/"+bg+".jpg")
            aonl_g.unlock("bg aonl_"+bg)
    
init 10 python:  # Поддержка фильтра "Табличный список модов"
    try:
        modsImages["art_of_new_life"] = (aonl_imgs + "misc/preview.png", False)
    except:
        pass
        
label art_of_new_life:
    $ persistent.sprite_time = "day"
    $ default_mouse = "aonl_un"
    $ config.window_title = u"Искусство новой жизни"
    scene bg black
    with dissolve
    pause 1
    play music aonl_mus_samidare fadein 2
    scene aonl_slideshow with dissolve2
    call screen aonl_main_menu with dissolve
    $ renpy.pause (1, hard=True)
    stop music fadeout 3
    scene bg black with fade3
    pause 1
    $ aonl_day = _return
    jump aonl_day_selector
        
screen aonl_main_menu:
    # Главное меню мода
    modal False
    window:
        area (0.05, 0.1, 0.35, 0.8)
        background None
        text "Искусство\nновой жизни":
            style "aonl_mm"
            size 70
            bold True
            color "#fff"
            xalign 0.5 yalign 0.05
        vbox:
            xalign 0.5 yalign 0.5
            textbutton "Начать игру":
                style "aonl_mm"
                text_style "aonl_mm"
                # action(Hide("aonl_main_menu", transition=dissolve), Return("prologue") )
                action(Hide("aonl_main_menu", transition=dissolve), Show("aonl_version") )
                xalign 0.5
            textbutton "Выбор дня":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_main_menu", transition=dissolve), Show("aonl_day_select") )
                xalign 0.5
            textbutton "Концовки":
                style "aonl_mm"
                text_style "aonl_mm"
                # action(Hide("aonl_main_menu", transition=dissolve), Show("aonl_endings") )
                xalign 0.5
            textbutton "Галерея":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_main_menu", transition=dissolve), Show("aonl_gallery_bg") )
                xalign 0.5
            textbutton "В главное меню":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_main_menu", transition=dissolve), Return("exit") )
                xalign 0.5
                
screen aonl_version:
    # Выбор версии мода
    modal False
    window:
        area (0.05, 0.05, 0.35, 0.9)
        background None
        text "Выбор версии":
            style "aonl_mm"
            size 70
            bold True
            color "#fff"
            xalign 0.5 yalign 0.0
        vbox:
            ypos 0.1
            xalign 0.5
            textbutton "Каноничная версия":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_version", transition=dissolve), Return("prologue") )
                xalign 0.5
            textbutton "Альтернативная версия":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day1:
                    action(Hide("aonl_version", transition=dissolve), Return("prologue_new") )
            textbutton "Назад":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                action(Hide("aonl_version", transition=dissolve), Show("aonl_main_menu") )
                
screen aonl_day_select:
    # Выбор дня
    modal False
    window:
        area (0.05, 0.05, 0.35, 0.9)
        background None
        text "Выбор дня":
            style "aonl_mm"
            size 70
            bold True
            color "#fff"
            xalign 0.5 yalign 0.0
        vbox:
            ypos 0.1
            xalign 0.5
            textbutton "Каноничная версия":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_day_select", transition=dissolve), Show("aonl_day_select_classic") )
                xalign 0.5
            textbutton "Альтернативная версия":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day1:
                    action(Hide("aonl_day_select", transition=dissolve), Show("aonl_day_select_new") )
            textbutton "Назад":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                action(Hide("aonl_day_select", transition=dissolve), Show("aonl_main_menu") )
                
screen aonl_day_select_new:
    # Выбор дня (наша версия, 10 дней)
    modal False
    window:
        area (0.05, 0.04, 0.35, 0.9)
        background None
        text "Альтернативная версия":
            style "aonl_mm"
            size 70
            bold True
            color "#fff"
            xalign 0.5 yalign 0.0
        vbox:
            ypos 0.16
            xalign 0.5
            textbutton "Пролог":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_day_select", transition=dissolve), Return("prologue_new") )
                xalign 0.5
            textbutton "День первый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day1:
                    action(Hide("aonl_day_select", transition=dissolve), Return("1") )
            textbutton "День второй":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day2:
                    action(Hide("aonl_day_select", transition=dissolve), Return("2") )
            textbutton "День третий":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day3:
                    action(Hide("aonl_day_select", transition=dissolve), Return("3") )
            textbutton "День четвёртый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day4:
                    action(Hide("aonl_day_select", transition=dissolve), Return("4") )
            textbutton "День пятый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day5:
                    action(Hide("aonl_day_select", transition=dissolve), Return("5") )
            textbutton "День шестой":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day6:
                    action(Hide("aonl_day_select", transition=dissolve), Return("6") )
            textbutton "День седьмой":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day7:
                    action(Hide("aonl_day_select", transition=dissolve), Return("7") )
            textbutton "День восьмой":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day8:
                    action(Hide("aonl_day_select", transition=dissolve), Return("8") )
            textbutton "День девятый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day9:
                    action(Hide("aonl_day_select", transition=dissolve), Return("9") )
            textbutton "День десятый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                if persistent.aonl_day10:
                    action(Hide("aonl_day_select", transition=dissolve), Return("10") )
            # textbutton "Эпилог":
                # style "aonl_mm"
                # text_style "aonl_mm"
                # xalign 0.5
                # if persistent.aonl_epilogue:
                    # action(Hide("aonl_day_select", transition=dissolve), Return("epilogue") )
            textbutton "Назад":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                action(Hide("aonl_day_select_new", transition=dissolve), Show("aonl_day_select") )
                
screen aonl_day_select_classic:
    # Выбор дня (канон, 7 дней)
    modal False
    window:
        area (0.05, 0.04, 0.35, 0.9)
        background None
        text "Каноничная версия":
            style "aonl_mm"
            size 70
            bold True
            color "#fff"
            xalign 0.5 yalign 0.0
        vbox:
            ypos 0.16
            xalign 0.5
            textbutton "Пролог":
                style "aonl_mm"
                text_style "aonl_mm"
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("prologue") )
                xalign 0.5
            textbutton "День первый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day1:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl1") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl1") )
            textbutton "День второй":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day2:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl2") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl2") )
            textbutton "День третий":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day3:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl3") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl3") )
            textbutton "День четвёртый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day4:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl4") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl4") )
            textbutton "День пятый":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day5:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl5") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl5") )
            textbutton "День шестой":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day6:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl6") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl6") )
            textbutton "День седьмой":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                # if persistent.aonl_day7:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl7") )
                action(Hide("aonl_day_select_classic", transition=dissolve), Return("cl7") )
            # textbutton "Эпилог":
                # style "aonl_mm"
                # text_style "aonl_mm"
                # xalign 0.5
                # if persistent.aonl_epilogue:
                    # action(Hide("aonl_day_select_classic", transition=dissolve), Return("epilogue") )
            textbutton "Назад":
                style "aonl_mm"
                text_style "aonl_mm"
                xalign 0.5
                action(Hide("aonl_day_select_classic", transition=dissolve), Show("aonl_day_select") )
                
screen aonl_gallery_bg:
    # Галерея БГ
    modal False
    $ len_table = len(aonl_gallery_bg)
    window:
        background "bg int_house_of_un_night"
        textbutton "Музыка":
            xalign 0.05 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_gallery_bg", transition=dissolve), Show("aonl_music_room") )
        textbutton "Фоны":
            xalign 0.5 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            text_color "#fff"
        textbutton "Иллюстрации":
            xalign 0.95 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_gallery_bg", transition=dissolve), Show("aonl_gallery_cg") )
        textbutton "Назад":
            style "aonl_mm"
            text_style "aonl_mm"
            xalign 0.05 yalign 0.95
            action(Hide("aonl_gallery_bg", transition=dissolve), Show("aonl_main_menu") )
        
        grid 4 3:
            xpos 0.09 ypos 0.20
            $ cg_displayed = 0
            for n in range(0, len_table):
                python:
                    _t = "art_of_new_life/images/bg/"+aonl_gallery_bg[n]+".jpg"
                    th = im.Scale(_t, 320, 180)
                    img = im.Composite((336,196),(8,8),im.Alpha(th,0.9),(0,0),im.Image(get_image("gui/gallery/thumbnail_idle.png")))
                    imgh = im.Composite((336,196),(8,8),th,(0,0),im.Image(get_image("gui/gallery/thumbnail_hover.png")))
                add aonl_g.make_button(aonl_gallery_bg[n], get_image("gui/gallery/blank.png"), None, imgh, img, style="blank_button", bottom_margin=50, right_margin=50)
                $ cg_displayed += 1

            for j in range(0, 12-cg_displayed):
                null

screen aonl_gallery_cg:
    # Галерея ЦГ
    modal False
    $ len_table = len(aonl_gallery_cg)
    window:
        background "bg aonl_ext_house_of_un_night"
        textbutton "Фоны":
            xalign 0.05 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_gallery_cg", transition=dissolve), Show("aonl_gallery_bg") )
        textbutton "Иллюстрации":
            xalign 0.5 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            text_color "#fff"
        textbutton "Музыка":
            xalign 0.95 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_gallery_cg", transition=dissolve), Show("aonl_music_room") )
        textbutton "Назад":
            style "aonl_mm"
            text_style "aonl_mm"
            xalign 0.05 yalign 0.95
            action(Hide("aonl_gallery_cg", transition=dissolve), Show("aonl_main_menu") )
        grid 4 3:
            xpos 0.09 ypos 0.20
            $ cg_displayed = 0
            for n in range(0, len_table):
                python:
                    _t = im.Crop("art_of_new_life/images/cg/"+aonl_gallery_cg[n]+".png" , (0,0,1920,1080))
                    th = im.Scale(_t, 320, 180)
                    img = im.Composite((336,196),(8,8),im.Alpha(th,0.9),(0,0),im.Image(get_image("gui/gallery/thumbnail_idle.png")))
                    imgh = im.Composite((336,196),(8,8),th,(0,0),im.Image(get_image("gui/gallery/thumbnail_hover.png")))
                add aonl_g.make_button(aonl_gallery_cg[n], get_image("gui/gallery/blank.png"), None, imgh, img, style="blank_button", bottom_margin=50, right_margin=50)
                $ cg_displayed += 1

            for j in range(0, 12-cg_displayed):
                null
        
screen aonl_music_room:
    # Музыка
    modal False
    window:
        background aonl_imgs + "bg/ext_musclub_night.jpg"
        textbutton "Иллюстрации":
            xalign 0.05 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_music_room", transition=dissolve), Show("aonl_gallery_cg") )
        textbutton "Музыка":
            xalign 0.5 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            text_color "#fff"
        textbutton "Фоны":
            xalign 0.95 yalign 0.05
            style "aonl_mm"
            text_style "aonl_mm"
            action (Hide("aonl_music_room", transition=dissolve), Show("aonl_gallery_bg") )
        textbutton "Назад":
            style "aonl_mm"
            text_style "aonl_mm"
            xalign 0.05 yalign 0.95
            action(Hide("aonl_music_room", transition=dissolve), Show("aonl_main_menu") )
        vbox:
            xalign 0.08 yalign 0.25
            
            textbutton "Yasuharu Takanashi/Yaiba – Samidare":
                style "aonl_mroom"
                text_style "aonl_mroom"
                action aonl_mr.Play("art_of_new_life/music/Samidare.mp3")
                
            if persistent.aonl_m_shitsui:
                textbutton "Takanashi Yasuharu – Shitsui":
                    style "aonl_mroom"
                    text_style "aonl_mroom"
                    action aonl_mr.Play("art_of_new_life/music/Shitsui.mp3")
            else:
                textbutton "ЗАКРЫТО":
                    style "aonl_mroom"
                    text_style "aonl_mroom"
                    
            if persistent.aonl_m_hazy_moon:
                textbutton "Hatsune Miku – Hazy Moon":
                    style "aonl_mroom"
                    text_style "aonl_mroom"
                    action aonl_mr.Play("art_of_new_life/music/Hazy Moon.mp3")
            else:
                textbutton "ЗАКРЫТО":
                    style "aonl_mroom"
                    text_style "aonl_mroom"
                    
            if persistent.aonl_m_silent_angel:
                textbutton "April Rain – My silent angel":
                    style "aonl_mroom"
                    text_style "aonl_mroom"
                    action aonl_mr.Play("art_of_new_life/music/silent_angel.ogg")
            else:
                textbutton "ЗАКРЫТО":
                    style "aonl_mroom"
                    text_style "aonl_mroom"

label aonl_day_selector:
    $ renpy.block_rollback()
    if aonl_day == "prologue":
        jump aonl_prologue_alt
    if aonl_day == "prologue_new":
        jump aonl_prologue
    elif aonl_day == "epilogue":
        jump aonl_epilogue
    elif aonl_day == "exit":
        $ config.mouse = aonl_config_mouse_backup
        $ config.window_title = aonl_config_window_title_backup
        return
    elif aonl_day.startswith("cl"):
        # Debug menu!!!
        menu:
            "Выбор в прологе"
            "Да, я пойду с тобой, милая.":
                $ aonl_classic_miku_route = False
            "Нет, я устала, надоели, оставьте меня в покое!":
                $ aonl_classic_miku_route = True
        if int(aonl_day[2]) > 2:
            menu:
                "Выбор рута"
                "Рут Лены":
                    $ aonl_un_story = True
                    $ aonl_sl_story = False
                    if int(aonl_day[2]) == 7:
                        jump aonl_day7_Lena
                "Рут Слави":
                    $ aonl_sl_story = True
                    $ aonl_un_story = False
                    if int(aonl_day[2]) == 7:
                        jump aonl_day7_Slyvia
        jump expression "aonl_day" + aonl_day[2] + "_alt"
                
    else:
        jump expression "aonl_day"+aonl_day

label aonl_new_chapter(day, dayt="", text="", text2="", text3="", route="un"):
    if day == 11:       # эпилог в каноничной версии
        $ save_name = "Искусство новой жизни.\nЭпилог"
        $ aonl_day_n = "Эпилог"
    elif day == 0:     # мало кто будет сохраняться на прологе, но надо делать всё идеально
        $ save_name = "Искусство новой жизни.\nПролог"
        $ aonl_day_n = "Пролог"
    elif day == 666:
        $ save_name = "Искусство новой жизни.\nДень ???"
        $ aonl_day_n = "День " + dayt
    else:
        $ save_name = "Искусство новой жизни.\nДень " + str(day)
        $ aonl_day_n = "День " + dayt
    scene aonl_days_bg with dissolve
    pause 1
    show text "{font=[aonl_rupster_script]}{size=50}[aonl_day_n]{/size}{/font}":
        xalign 0.05 yalign 0.05
    show text "{font=[aonl_rupster_script]}{size=50}[text]{/size}{/font}" as text2:
        xalign 0.95 yalign 0.05
    with dissolve
    if day == 7 and route == "un":
        pause
        show text "{font=[aonl_rupster_script]}{size=50}[text2]{/size}{/font}" as text2 with dissolve:
            xalign 0.95 yalign 0.05
        pause
        show text "{font=[aonl_rupster_script]}{size=50}[text3]{/size}{/font}" as text2 with dissolve:
            xalign 0.95 yalign 0.05
    pause
    scene bg black with dissolve
    pause 2
    return

    
